CREATE TABLE drones (
    id                            INT                           UNIQUE GENERATED BY DEFAULT AS IDENTITY,
    name                          TEXT                          NOT NULL,
    brand                         TEXT                          NOT NULL,
    model                         TEXT                          NOT NULL,
    additional                    TEXT
);

CREATE TABLE users (
    id                            INT                           UNIQUE GENERATED BY DEFAULT AS IDENTITY,
    name                          TEXT                          NOT NULL,
    username                      TEXT                          NOT NULL UNIQUE
);

CREATE TABLE analytics (
    id                            INT                           UNIQUE GENERATED BY DEFAULT AS IDENTITY,
    name                          TEXT,                         
    description                   TEXT,          
    /* Point is a non-standard data type: https://www.postgresql.org/docs/9.4/datatype-geometric.html */               
    location                      POINT,                       
    timestamp                     TIMESTAMP
);

CREATE TABLE pictures (
    id                            INT                           UNIQUE GENERATED BY DEFAULT AS IDENTITY
);

CREATE TABLE picture_analytics (
    picture                       INT                           REFERENCES pictures (id) ON DELETE CASCADE,
    analytic                      INT                           REFERENCES analytics (id) ON DELETE CASCADE,

    PRIMARY KEY (picture, analytic)
);

CREATE TABLE drone_users (
    drone                         INT                           REFERENCES drones (id) ON DELETE CASCADE,
    "user"                        INT                           REFERENCES users (id) ON DELETE CASCADE,

    PRIMARY KEY (drone, "user")
);

CREATE TABLE drone_pictures (
    drone                         INT                           REFERENCES drones (id) ON DELETE CASCADE,
    picture                       INT                           REFERENCES pictures (id) ON DELETE CASCADE,
    "user"                        INT                           REFERENCES users (id) ON DELETE CASCADE,

    PRIMARY KEY (drone, picture, "user")
);
